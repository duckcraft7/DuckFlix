<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DuckFlix - Carregando...</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">
    <style>
        .movie-card.focused {
            transform: scale(1.08);
            border: 4px solid #FFD700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.7);
            z-index: 10;
        }
    </style>
</head>
<body>

    <header class="main-header">
        <h1>DuckFlix</h1>
        <p>Seu cinema particular.</p>
    </header>

    <main id="catalog-container">
        <h2>Carregando catálogo...</h2>
    </main>

    <footer class="main-footer">
        <p>&copy; 2025 DuckFlix. Feito com ❤️ para os amantes de cinema.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // SUBSTITUA PELO SEU LINK DO VERCEL
            const listaUrl = 'https://duckflix-lista.vercel.app/lista.json'; 

            const catalogContainer = document.getElementById('catalog-container');

            fetch(listaUrl)
                .then(response => response.json())
                .then(data => {
                    catalogContainer.innerHTML = ''; 
                    data.categorias.forEach(categoria => {
                        const section = document.createElement('section');
                        section.className = 'movie-section';
                        const title = document.createElement('h2');
                        title.textContent = categoria.titulo;
                        section.appendChild(title);
                        const grid = document.createElement('div');
                        grid.className = 'movie-grid';

                        categoria.items.forEach(item => {
                            const cardLink = document.createElement('a');
                            cardLink.className = 'movie-card';
                            
                            // ---- A CORREÇÃO ESTÁ AQUI ----
                            // O nome da chave foi trocado de 'videoLink' para 'videolink' (minúsculo)
                            const playerLink = `player.html?src=${encodeURIComponent(item.videolink)}&title=${encodeURIComponent(item.titulo)}`;
                            
                            cardLink.href = playerLink; 
                            
                            cardLink.innerHTML = `
                                <img src="${item.poster}" alt="Pôster de ${item.titulo}">
                                <div class="movie-info">
                                    <h3>${item.titulo}</h3>
                                    <p>${item.ano}</p>
                                </div>
                            `;
                            grid.appendChild(cardLink);
                        });
                        section.appendChild(grid);
                        catalogContainer.appendChild(section);
                    });
                    setupNavigation();
                })
                .catch(error => {
                    catalogContainer.innerHTML = '<h2>Erro ao carregar o catálogo.</h2>';
                });

            // A função de navegação continua a mesma
            function setupNavigation() {
                const movieCards = document.querySelectorAll('.movie-card');
                if (movieCards.length === 0) return;
                let currentFocusIndex = 0;

                const setFocus = (index) => {
                    movieCards[currentFocusIndex].classList.remove('focused');
                    currentFocusIndex = index;
                    movieCards[currentFocusIndex].classList.add('focused');
                    movieCards[currentFocusIndex].scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'nearest' });
                };

                document.addEventListener('keydown', (event) => {
                    event.preventDefault(); 
                    const grid = movieCards[currentFocusIndex].closest('.movie-grid');
                    if (!grid) return; 
                    const gridStyle = window.getComputedStyle(grid);
                    const gridColumnCount = gridStyle.getPropertyValue('grid-template-columns').split(' ').length;

                    switch (event.key) {
                        case 'ArrowRight':
                            const isLastInRow = (currentFocusIndex + 1) % gridColumnCount === 0;
                            if (currentFocusIndex < movieCards.length - 1 && !isLastInRow) setFocus(currentFocusIndex + 1);
                            break;
                        case 'ArrowLeft':
                            const isFirstInRow = currentFocusIndex % gridColumnCount === 0;
                             if (currentFocusIndex > 0 && !isFirstInRow) setFocus(currentFocusIndex - 1);
                            break;
                        case 'ArrowDown':
                            const targetIndexDown = currentFocusIndex + gridColumnCount;
                            if (targetIndexDown < movieCards.length) setFocus(targetIndexDown);
                            break;
                        case 'ArrowUp':
                             const targetIndexUp = currentFocusIndex - gridColumnCount;
                            if (targetIndexUp >= 0) setFocus(targetIndexUp);
                            break;
                        case 'Enter':
                            const targetUrl = movieCards[currentFocusIndex].getAttribute('href');
                            if (targetUrl) {
                                window.location.href = targetUrl;
                            }
                            break;
                    }
                });
                setFocus(0);
            }
        });
    </script>
</body>
</html>

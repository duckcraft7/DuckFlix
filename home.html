<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DuckFlix - Catálogo</title>
    <link rel="stylesheet" href="style.css"> 
    <style>
        /* Estilos adicionais para o cabeçalho e botão Sair */
        .header-actions {
            position: absolute;
            top: 20px;
            right: 20px;
        }
        .logout-button {
            background-color: #CC0000;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        .logout-button:hover {
            background-color: #990000;
        }
    </style>
</head>
<body>

    <header class="main-header">
        <h1>DuckFlix</h1>
        <div class="header-actions">
            <button class="logout-button" onclick="logout()">Sair da conta</button>
        </div>
    </header>

    <main id="catalog-container">
        </main>

    <script>
        // =========================================================
        // === CONTROLE DE SESSÃO E LOGOUT ===
        // =========================================================

        // 1. FUNÇÃO DE LOGOUT
        function logout() {
            // Apaga a chave de autenticação do armazenamento local
            localStorage.removeItem('duckflix_auth_pin');
            // Redireciona o usuário de volta para a tela de login
            window.location.href = 'index.html';
        }

        // 2. VERIFICAÇÃO DE SESSÃO AO CARREGAR A PÁGINA
        function checkSession() {
            const pinSalvo = localStorage.getItem('duckflix_auth_pin');
            
            // Se o PIN não estiver salvo, o usuário não está logado. Redirecionar.
            if (!pinSalvo) {
                // Você pode até redirecionar para a tela de login
                window.location.href = 'index.html'; 
                return false;
            }
            return true;
        }

        // 3. LÓGICA DE INICIALIZAÇÃO
        document.addEventListener('DOMContentLoaded', () => {
            if (checkSession()) {
                // Se a sessão for válida, carregue o catálogo de filmes
                carregarCatalogo(); 
            }
            // Se não for válida, a função checkSession já redirecionou o usuário.
        });


        // =========================================================
        // === LÓGICA DO CATÁLOGO (O SEU CÓDIGO ANTERIOR) ===
        // =========================================================

        const listaUrl = 'https://duckflix-lista.vercel.app/lista.json';

        function carregarCatalogo() {
            fetch(listaUrl)
                .then(response => response.json())
                .then(data => {
                    const catalogContainer = document.getElementById('catalog-container');
                    catalogContainer.innerHTML = '';
                    // ... Seu código anterior para construir o catálogo com base em 'data' ...
                    // ... E a função setupNavigation() para o controle remoto ...
                    
                    // Exemplo simplificado de construção do catálogo:
                    data.categorias.forEach(categoria => {
                        const section = document.createElement('section');
                        section.innerHTML = `<h2>${categoria.nome}</h2>`;
                        // ... crie a grade de filmes aqui
                        catalogContainer.appendChild(section);
                    });
                    
                    setupNavigation(); // Chame a navegação da TV
                })
                .catch(error => {
                    console.error('Erro ao carregar a lista de filmes:', error);
                    document.getElementById('catalog-container').innerHTML = '<h2>Erro ao carregar o catálogo.</h2>';
                });
        }
        
        // ... Insira aqui a sua função setupNavigation() com a lógica do controle remoto ...
        
    </script>
</body>
</html>

